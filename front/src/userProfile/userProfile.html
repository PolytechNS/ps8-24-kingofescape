<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test d'Ajout d'Ami</title>
</head>
<body>
<h2>Ajouter un ami</h2>
<input type="text" id="username" placeholder="Nom d'utilisateur">
<button id="addFriend">Ajouter comme ami</button>

<!-- Ajout de l'élément pour afficher la liste d'amis -->
<h2>Liste d'Amis</h2>
<ul id="friendsList"></ul>

<script>
    document.getElementById("addFriend").addEventListener("click", function() {
        const recipientUsername = document.getElementById("username").value;
        let token=document.cookie.split('=')[1];

        fetch('http://localhost:8000/api/sendFriendRequest', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({ recipient: recipientUsername, token: token }),
        })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    });



    function fetchFriends() {
        fetch('http://localhost:8000/api/users')
            .then(response => response.json())
            .then(data => {
                const friendsList = document.getElementById('friendsList');
                friendsList.innerHTML = '';
                data.forEach(friend => {
                    const li = document.createElement('li');
                    li.textContent = friend.username; // ou tout autre attribut de l'ami
                    friendsList.appendChild(li);
                });
            })
            .catch(error => console.error('Erreur:', error));
    }

    fetchFriends();
</script>
</body>
</html>
